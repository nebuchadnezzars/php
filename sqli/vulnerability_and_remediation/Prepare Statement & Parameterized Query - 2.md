# PHP - Prepare Statement & Parameterized Query - 2

SQLi;  kullanıcı tarafından kontrol edilen verilerin doğrudan SQL sorgularına eklenmesi nedeniyle ortaya çıkar.

PHP'de sql injection saldırısını önlemek için prepared statement ile parametrized yöntemi için kaç çeşit yol var?

PHP'de SQL injection saldırılarını önlemek için kullanılan prepared statement ile parametrized sorgular, genellikle iki ana yöntemle uygulanır:

**PDO (PHP Data Objects):**

- PDO, PHP için veritabanı erişimi sağlayan bir arayüzdür.
- Birden fazla veritabanı sürücüsünü destekler (MySQL, PostgreSQL, SQLite ve diğerleri).
- Güvenli veritabanı işlemleri için prepared statement ve parametrized sorguları destekler.
- Veritabanı bağlantısı oluşturduktan sonra, prepared statement'lar **`prepare`** metodu ile oluşturulur ve parametreler **`bindParam`** veya **`bindValue`** metotlarıyla atanır.
- Örnek:

```sql
$pdo = new PDO($dsn, $user, $password);
$stmt = $pdo->prepare("SELECT * FROM users WHERE email = :email AND status=:status");
$stmt->bindParam(':email', $email);
$stmt->bindParam(':status', $status);
$stmt->execute();

$pdo = new PDO($dsn, $user, $password);
$stmt = $pdo->prepare("SELECT * FROM users WHERE email = :email AND status=:status");
$stmt->bindValue(':email', $email);
$stmt->bindValue(':status', $status);
$stmt->execute();
```

**MySQLi (MySQL Improved):**

- MySQLi, MySQL veritabanları için geliştirilmiştir.
- Yalnızca MySQL veritabanlarını destekler.
- Prepared statement ve parametrized sorgular için özellikler sunar.
- Veritabanı bağlantısı oluşturulduktan sonra, prepared statement'lar **`prepare`** metodu ile oluşturulur ve parametreler **`bind_param`** metoduyla atanır.
- Örnek:

```sql
$mysqli = new mysqli($host, $user, $password, $database);
$stmt = $mysqli->prepare("SELECT * FROM users WHERE email = ? AND status=?");
$stmt->bind_param('ss', $email, $status);
$stmt->execute();

```

**`'ss'`** kodunda her bir 's' karakteri, bağlanacak değişkenin bir string olduğunu gösterir. Dolayısıyla bu örnekte, hem **`$email`** hem de **`$status`** değişkenleri için string türünde olduğu belirtilmiştir.

MySQLi'de bind_param ile kullanılabilecek veri türleri aşağıdaki gibidir:

- **`'i'`** – integer (tam sayı)
- **`'d'`** – double (ondalıklı sayı)
- **`'s'`** – string (metin)
- **`'b'`** – blob (dosya, ikili veri)

Kullanacağınız değişkenlerin türüne göre bu kodları uygun şekilde ayarlamanız gerekir. Örneğin, bir tam sayı ve bir metin göndermek istiyorsanız, **`bind_param('is', ...)`** şeklinde bir kullanım yapılabilir.

Her iki yöntem de veritabanı sorgularını güvenli bir şekilde yapmak için parametrized sorgular ve prepared statement'lar kullanır. Seçim, genellikle projenin gereksinimlerine ve kullanılan veritabanı türüne bağlıdır. Özellikle, PDO'nun birden fazla veritabanı türünü desteklemesi ve MySQLi'nin MySQL'e özel optimizasyonları sunması gibi faktörler tercih sebebi olabilir.